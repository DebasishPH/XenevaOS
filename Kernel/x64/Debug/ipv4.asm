; Listing generated by Microsoft (R) Optimizing Compiler Version 18.00.21005.1 

include listing.inc

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?CreateIPv4Socket@@YAHHH@Z			; CreateIPv4Socket
EXTRN	?CreateTCPSocket@@YAHXZ:PROC			; CreateTCPSocket
EXTRN	?CreateICMPSocket@@YAHXZ:PROC			; CreateICMPSocket
EXTRN	?CreateUDPSocket@@YAHXZ:PROC			; CreateUDPSocket
pdata	SEGMENT
$pdata$?CreateIPv4Socket@@YAHHH@Z DD imagerel $LN11
	DD	imagerel $LN11+95
	DD	imagerel $unwind$?CreateIPv4Socket@@YAHHH@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?CreateIPv4Socket@@YAHHH@Z DD 010c01H
	DD	0620cH
xdata	ENDS
; Function compile flags: /Odtpy
; File e:\xeneva project\aurora\kernel\net\ipv4.cpp
_TEXT	SEGMENT
tv64 = 32
type$ = 64
protocol$ = 72
?CreateIPv4Socket@@YAHHH@Z PROC				; CreateIPv4Socket

; 41   : int CreateIPv4Socket(int type, int protocol) {

$LN11:
	mov	DWORD PTR [rsp+16], edx
	mov	DWORD PTR [rsp+8], ecx
	sub	rsp, 56					; 00000038H

; 42   : 	switch (type) {

	mov	eax, DWORD PTR type$[rsp]
	mov	DWORD PTR tv64[rsp], eax
	cmp	DWORD PTR tv64[rsp], 1
	je	SHORT $LN2@CreateIPv4
	cmp	DWORD PTR tv64[rsp], 2
	je	SHORT $LN6@CreateIPv4
	jmp	SHORT $LN1@CreateIPv4
$LN6@CreateIPv4:

; 43   : 	case SOCK_DGRAM:
; 44   : 		if (protocol == 0 || protocol == IPPROTOCOL_UDP)

	cmp	DWORD PTR protocol$[rsp], 0
	je	SHORT $LN4@CreateIPv4
	cmp	DWORD PTR protocol$[rsp], 17
	jne	SHORT $LN5@CreateIPv4
$LN4@CreateIPv4:

; 45   : 			return CreateUDPSocket();

	call	?CreateUDPSocket@@YAHXZ			; CreateUDPSocket
	jmp	SHORT $LN9@CreateIPv4
$LN5@CreateIPv4:

; 46   : 		if (protocol == IPPROTOCOL_ICMP)

	cmp	DWORD PTR protocol$[rsp], 1
	jne	SHORT $LN3@CreateIPv4

; 47   : 			return CreateICMPSocket();

	call	?CreateICMPSocket@@YAHXZ		; CreateICMPSocket
	jmp	SHORT $LN9@CreateIPv4
$LN3@CreateIPv4:

; 48   : 		return -1;

	mov	eax, -1
	jmp	SHORT $LN9@CreateIPv4
$LN2@CreateIPv4:

; 49   : 	case SOCK_STREAM:
; 50   : 		return CreateTCPSocket();

	call	?CreateTCPSocket@@YAHXZ			; CreateTCPSocket
	jmp	SHORT $LN9@CreateIPv4
$LN1@CreateIPv4:

; 51   : 	default:
; 52   : 		return -1;

	mov	eax, -1
$LN9@CreateIPv4:

; 53   : 	}
; 54   : }

	add	rsp, 56					; 00000038H
	ret	0
?CreateIPv4Socket@@YAHHH@Z ENDP				; CreateIPv4Socket
_TEXT	ENDS
END
